/**\n * ğŸ§’ NeuroNutrition - Hook d'adaptation UX selon l'Ã¢ge patient\n * \n * Logique centralisÃ©e pour adapter l'interface selon l'Ã¢ge dÃ©tectÃ©\n */\n\nimport { useState, useEffect } from 'react';\nimport type { AgeVariant } from '@neuronutrition/shared-questionnaires';\n\nexport interface PatientAgeData {\n  birthDate?: string | Date;\n  uid: string;\n  ageVariant?: AgeVariant;\n  patientAge?: number;\n}\n\nexport interface UXAdaptation {\n  variant: AgeVariant;\n  age: number | null;\n  needsParentHelp: boolean;\n  encouragementLevel: 'low' | 'medium' | 'high';\n  visualStyle: {\n    colors: string;\n    fontSize: string;\n    spacing: string;\n    animations: boolean;\n  };\n  language: {\n    formality: 'formal' | 'informal' | 'simple';\n    encouragement: string[];\n    helpTexts: string;\n  };\n}\n\nconst UX_ADAPTATIONS: Record<AgeVariant, Omit<UXAdaptation, 'age'>> = {\n  kid: {\n    variant: 'kid',\n    needsParentHelp: true,\n    encouragementLevel: 'high',\n    visualStyle: {\n      colors: 'from-yellow-400 to-orange-400',\n      fontSize: 'text-lg',\n      spacing: 'space-y-6',\n      animations: true\n    },\n    language: {\n      formality: 'simple',\n      encouragement: [\n        'ğŸŒŸ Super ! Tu rÃ©ponds trÃ¨s bien !',\n        'ğŸˆ Bravo ! Continue comme Ã§a !',\n        'ğŸ¦‹ Tu es formidable !',\n        'ğŸŒˆ Excellent travail !',\n        'â­ Tu y arrives trÃ¨s bien !'\n      ],\n      helpTexts: 'ğŸŒŸ Tu peux demander de l\\'aide Ã  tes parents pour rÃ©pondre !'\n    }\n  },\n  teen: {\n    variant: 'teen',\n    needsParentHelp: false,\n    encouragementLevel: 'medium',\n    visualStyle: {\n      colors: 'from-blue-400 to-purple-400',\n      fontSize: 'text-base',\n      spacing: 'space-y-4',\n      animations: true\n    },\n    language: {\n      formality: 'informal',\n      encouragement: [\n        'ğŸ’ª TrÃ¨s bien ! Continue !',\n        'ğŸŒŸ Tu gÃ¨res parfaitement !',\n        'âš¡ Super boulot !',\n        'ğŸ¯ Parfait ! Plus qu\\'un peu !'\n      ],\n      helpTexts: 'ğŸ’¡ RÃ©ponds selon ce que tu ressens vraiment, il n\\'y a pas de bonne ou mauvaise rÃ©ponse !'\n    }\n  },\n  adult: {\n    variant: 'adult',\n    needsParentHelp: false,\n    encouragementLevel: 'low',\n    visualStyle: {\n      colors: 'from-gray-400 to-gray-600',\n      fontSize: 'text-base',\n      spacing: 'space-y-4',\n      animations: false\n    },\n    language: {\n      formality: 'formal',\n      encouragement: ['TrÃ¨s bien, continuez !'],\n      helpTexts: 'RÃ©pondez selon votre situation actuelle.'\n    }\n  }\n};\n\n/**\n * ğŸ¯ Hook principal pour l'adaptation UX selon l'Ã¢ge\n */\nexport function usePatientUX(patientData?: PatientAgeData): UXAdaptation {\n  const [uxConfig, setUXConfig] = useState<UXAdaptation>({\n    ...UX_ADAPTATIONS.adult,\n    age: null\n  });\n\n  useEffect(() => {\n    if (!patientData) {\n      setUXConfig({ ...UX_ADAPTATIONS.adult, age: null });\n      return;\n    }\n\n    // Utilisation des donnÃ©es prÃ©-calculÃ©es si disponibles\n    if (patientData.ageVariant && patientData.patientAge !== undefined) {\n      const adaptation = UX_ADAPTATIONS[patientData.ageVariant];\n      setUXConfig({\n        ...adaptation,\n        age: patientData.patientAge\n      });\n      return;\n    }\n\n    // Calcul Ã  partir de la date de naissance si nÃ©cessaire\n    if (patientData.birthDate) {\n      const age = calculateAge(patientData.birthDate);\n      const variant = getAgeVariant(age);\n      const adaptation = UX_ADAPTATIONS[variant];\n      \n      setUXConfig({\n        ...adaptation,\n        age\n      });\n    }\n  }, [patientData]);\n\n  return uxConfig;\n}\n\n/**\n * ğŸ§® Calcul de l'Ã¢ge Ã  partir de la date de naissance\n */\nfunction calculateAge(birthDate: string | Date): number {\n  const birth = new Date(birthDate);\n  const today = new Date();\n  let age = today.getFullYear() - birth.getFullYear();\n  const monthDiff = today.getMonth() - birth.getMonth();\n  \n  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n    age--;\n  }\n  \n  return age;\n}\n\n/**\n * ğŸ¯ DÃ©termination de la variante d'Ã¢ge\n */\nfunction getAgeVariant(age: number): AgeVariant {\n  if (age >= 18) return 'adult';\n  if (age >= 13) return 'teen';\n  return 'kid';\n}\n\n/**\n * ğŸ¨ Hook pour les styles visuels adaptatifs\n */\nexport function useAdaptiveStyles(variant: AgeVariant) {\n  const config = UX_ADAPTATIONS[variant];\n  \n  return {\n    containerClass: `bg-gradient-to-r ${config.visualStyle.colors} text-white`,\n    textClass: config.visualStyle.fontSize,\n    spacingClass: config.visualStyle.spacing,\n    shouldAnimate: config.visualStyle.animations,\n    \n    // Classes Tailwind prÃ©-construites\n    cardClass: variant === 'kid' \n      ? 'border-2 border-yellow-300 bg-gradient-to-br from-yellow-50 to-orange-50'\n      : variant === 'teen'\n      ? 'border-2 border-blue-300 bg-gradient-to-br from-blue-50 to-purple-50'\n      : 'border-gray-200',\n      \n    buttonClass: variant === 'kid'\n      ? 'text-lg h-14 px-8'\n      : variant === 'teen'\n      ? 'text-base h-12 px-6'\n      : 'text-sm h-10 px-4'\n  };\n}\n\n/**\n * ğŸ’¬ Hook pour les messages adaptatifs\n */\nexport function useAdaptiveLanguage(variant: AgeVariant) {\n  const config = UX_ADAPTATIONS[variant];\n  \n  const getRandomEncouragement = () => {\n    const messages = config.language.encouragement;\n    return messages[Math.floor(Math.random() * messages.length)];\n  };\n  \n  const getNavigationText = (isNext: boolean, isLast: boolean) => {\n    if (variant === 'kid') {\n      if (isNext) {\n        return isLast ? 'ğŸ‰ Terminer !' : 'Question suivante â†’';\n      } else {\n        return 'â† Question d\\'avant';\n      }\n    } else if (variant === 'teen') {\n      if (isNext) {\n        return isLast ? 'ğŸ¯ Terminer' : 'Suivant â†’';\n      } else {\n        return 'â† PrÃ©cÃ©dent';\n      }\n    } else {\n      return isNext ? (isLast ? 'Terminer' : 'Suivant') : 'PrÃ©cÃ©dent';\n    }\n  };\n  \n  const getProgressText = (current: number, total: number) => {\n    const progress = Math.round((current / total) * 100);\n    \n    switch (variant) {\n      case 'kid':\n        return `ğŸˆ Tu as rÃ©pondu Ã  ${current} questions sur ${total} !`;\n      case 'teen':\n        return `${progress}% terminÃ© - Plus que ${total - current} questions !`;\n      default:\n        return `${current} sur ${total} questions`;\n    }\n  };\n  \n  return {\n    formality: config.language.formality,\n    helpText: config.language.helpTexts,\n    getRandomEncouragement,\n    getNavigationText,\n    getProgressText\n  };\n}\n\n/**\n * ğŸ”§ Hook pour la gestion du mode parent/enfant\n */\nexport function useParentAssistance(variant: AgeVariant) {\n  const [isParentHelping, setIsParentHelping] = useState(false);\n  const [childUnderstands, setChildUnderstands] = useState(true);\n  \n  const isAvailable = variant === 'kid';\n  \n  const toggleParentHelp = () => {\n    if (isAvailable) {\n      setIsParentHelping(prev => !prev);\n    }\n  };\n  \n  const getAssistanceText = () => {\n    if (!isAvailable) return null;\n    \n    return {\n      status: isParentHelping ? 'Papa ou maman m\\'aide Ã  rÃ©pondre' : 'Je rÃ©ponds tout seul(e)',\n      buttonText: isParentHelping ? 'âœ… Avec aide' : 'ğŸ‘‹ Demander de l\\'aide',\n      instruction: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Papa ou maman peuvent t\\'aider Ã  rÃ©pondre !'\n    };\n  };\n  \n  return {\n    isAvailable,\n    isParentHelping,\n    childUnderstands,\n    setChildUnderstands,\n    toggleParentHelp,\n    getAssistanceText\n  };\n}